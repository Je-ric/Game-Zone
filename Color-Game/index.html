<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Carnival Color Cubes</title>
    <!-- Tailwind CSS via CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* 3D Cube Styles */
        .scene {
            perspective: 600px;
            width: 120px;
            height: 120px;
            margin: 0 auto;
        }
        
        .cube {
            width: 100%;
            height: 100%;
            position: relative;
            transform-style: preserve-3d;
            transition: transform 1.5s;
        }
        
        .cube-face {
            position: absolute;
            width: 120px;
            height: 120px;
            border: 2px solid rgba(255, 255, 255, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: white;
            text-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
            box-shadow: inset 0 0 20px rgba(0, 0, 0, 0.2);
        }
        
        /* Cube face positions */
        .front  { transform: rotateY(0deg) translateZ(60px); }
        .right  { transform: rotateY(90deg) translateZ(60px); }
        .back   { transform: rotateY(180deg) translateZ(60px); }
        .left   { transform: rotateY(-90deg) translateZ(60px); }
        .top    { transform: rotateX(90deg) translateZ(60px); }
        .bottom { transform: rotateX(-90deg) translateZ(60px); }
        
        /* Animations */
        @keyframes spin {
            0% { transform: rotateX(0) rotateY(0); }
            100% { transform: rotateX(360deg) rotateY(720deg); }
        }
        
        .spinning {
            animation: spin 1.5s ease-out;
        }
        
        /* Color selection styles */
        .color-option {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.2s;
            border: 3px solid transparent;
        }
        
        .color-option:hover {
            transform: scale(1.1);
        }
        
        .color-option.selected {
            border-color: white;
            transform: scale(1.1);
            box-shadow: 0 0 15px rgba(255, 255, 255, 0.8);
        }
        
        /* Confetti animation for wins */
        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            background-color: #f00;
            opacity: 0;
            animation: confetti-fall 3s ease-in-out forwards;
            z-index: 100;
        }
        
        @keyframes confetti-fall {
            0% {
                transform: translateY(-100px) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(calc(100vh + 100px)) rotate(360deg);
                opacity: 0;
            }
        }
        
        /* Betting chip styles */
        .betting-chip {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: white;
            cursor: pointer;
            transition: all 0.2s;
            border: 3px dashed white;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .betting-chip:hover {
            transform: scale(1.1);
        }
        
        .betting-chip.selected {
            border-style: solid;
            transform: scale(1.1);
            box-shadow: 0 0 15px rgba(255, 255, 255, 0.5);
        }
        
        /* Balance change animation */
        .balance-change {
            animation: balance-pop 0.5s ease-out;
        }
        
        @keyframes balance-pop {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }
        
        /* Payout table styles */
        .payout-table {
            border-collapse: separate;
            border-spacing: 0;
            width: 100%;
            border-radius: 8px;
            overflow: hidden;
        }
        
        .payout-table th, .payout-table td {
            padding: 8px 12px;
            text-align: center;
        }
        
        .payout-table th {
            background-color: rgba(79, 70, 229, 0.2);
            font-weight: bold;
        }
        
        .payout-table tr:nth-child(even) {
            background-color: rgba(255, 255, 255, 0.05);
        }
    </style>
</head>
<body class="bg-gray-900 text-white min-h-screen">
    <!-- Carnival Tent Background -->
    <div class="absolute inset-0 bg-gradient-to-b from-red-900 to-gray-900 opacity-50 z-0"></div>
    
    <div class="relative z-10 max-w-4xl mx-auto p-4">
        <!-- Header -->
        <header class="text-center py-6">
            <h1 class="text-4xl md:text-5xl font-bold text-yellow-400 drop-shadow-lg">Carnival Color Cubes</h1>
            <p class="text-xl text-yellow-200 mt-2">Place your bets and test your luck!</p>
        </header>
        
        <!-- Game Container -->
        <div class="bg-gray-800 rounded-xl shadow-2xl overflow-hidden">
            <!-- Game Controls -->
            <div class="bg-gradient-to-r from-purple-900 to-blue-900 p-4 flex flex-col md:flex-row justify-between items-center">
                <!-- Difficulty Selection -->
                <div class="mb-4 md:mb-0">
                    <span class="text-yellow-200 mr-2">Difficulty:</span>
                    <div class="inline-flex rounded-md shadow-sm" role="group">
                        <button id="easyBtn" class="difficulty-btn px-4 py-2 text-sm font-medium bg-blue-700 text-white rounded-l-lg hover:bg-blue-800 focus:z-10 focus:ring-2 focus:ring-blue-300 active">
                            Easy (3 Cubes)
                        </button>
                        <button id="mediumBtn" class="difficulty-btn px-4 py-2 text-sm font-medium bg-blue-600 text-white rounded-r-lg hover:bg-blue-800 focus:z-10 focus:ring-2 focus:ring-blue-300">
                            Medium (6 Cubes)
                        </button>
                    </div>
                </div>
                
                <!-- Player Balance -->
                <div class="bg-gray-900 rounded-lg p-3 flex items-center">
                    <div class="mr-3">
                        <div class="text-sm text-gray-400">Your Balance</div>
                        <div id="balanceDisplay" class="text-2xl font-bold text-yellow-400">1000</div>
                    </div>
                    <div class="betting-chip bg-yellow-600">
                        <span>$</span>
                    </div>
                </div>
            </div>
            
            <!-- Main Game Area -->
            <div class="p-6 grid grid-cols-1 md:grid-cols-2 gap-6">
                <!-- Left Side: Cubes and Result -->
                <div class="flex flex-col items-center">
                    <h2 class="text-2xl font-bold mb-4 text-center">The Color Cubes</h2>
                    
                    <!-- Cubes Container -->
                    <div id="cubesContainer" class="grid grid-cols-3 gap-4 mb-6">
                        <!-- Cubes will be generated here -->
                    </div>
                    
                    <!-- Result Message -->
                    <div id="resultMessage" class="text-xl font-bold h-8 mb-4 text-center"></div>
                    
                    <!-- Roll Button -->
                    <button id="rollButton" class="bg-gradient-to-r from-red-600 to-yellow-600 hover:from-red-700 hover:to-yellow-700 text-white font-bold py-3 px-8 rounded-full shadow-lg transform transition hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed">
                        ROLL THE CUBES
                    </button>
                </div>
                
                <!-- Right Side: Betting Options -->
                <div>
                    <h2 class="text-2xl font-bold mb-4 text-center">Place Your Bet</h2>
                    
                    <!-- Color Selection -->
                    <div class="mb-6">
                        <p class="text-gray-300 mb-2">Select a color:</p>
                        <div id="colorOptions" class="flex flex-wrap justify-center gap-4">
                            <div class="color-option bg-red-500" data-color="Red"></div>
                            <div class="color-option bg-blue-500" data-color="Blue"></div>
                            <div class="color-option bg-green-500" data-color="Green"></div>
                            <div class="color-option bg-yellow-500" data-color="Yellow"></div>
                            <div class="color-option bg-purple-500" data-color="Purple"></div>
                            <div class="color-option bg-orange-500" data-color="Orange"></div>
                        </div>
                    </div>
                    
                    <!-- Bet Amount -->
                    <div class="mb-6">
                        <p class="text-gray-300 mb-2">Bet amount:</p>
                        <div class="flex justify-center gap-3">
                            <div class="betting-chip bg-red-600" data-amount="10">10</div>
                            <div class="betting-chip bg-green-600" data-amount="50">50</div>
                            <div class="betting-chip bg-blue-600" data-amount="100">100</div>
                            <div class="betting-chip bg-purple-600" data-amount="500">500</div>
                        </div>
                    </div>
                    
                    <!-- Custom Bet Input -->
                    <div class="flex justify-center items-center gap-2 mb-4">
                        <input type="number" id="customBetInput" min="1" max="10000" value="10" class="w-24 px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white">
                        <button id="setCustomBetBtn" class="bg-indigo-600 hover:bg-indigo-700 text-white px-3 py-2 rounded-md">
                            Set Bet
                        </button>
                    </div>
                    
                    <!-- Current Bet Display -->
                    <div class="bg-gray-700 rounded-lg p-4 text-center mb-4">
                        <p class="text-gray-400">Current Bet</p>
                        <div class="flex justify-center items-center gap-2">
                            <div id="selectedColorDisplay" class="w-6 h-6 rounded-full bg-gray-500"></div>
                            <span id="betAmountDisplay" class="text-2xl font-bold">0</span>
                        </div>
                    </div>
                    
                    <!-- Payout Table -->
                    <div class="bg-gray-700 rounded-lg p-4">
                        <h3 class="text-center font-bold mb-2">Payout Table</h3>
                        <table class="payout-table">
                            <thead>
                                <tr>
                                    <th>Occurrences</th>
                                    <th>Payout</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>1</td>
                                    <td>2x bet</td>
                                </tr>
                                <tr>
                                    <td>2</td>
                                    <td>3x bet</td>
                                </tr>
                                <tr>
                                    <td>3</td>
                                    <td>5x bet</td>
                                </tr>
                                <tr>
                                    <td>4</td>
                                    <td>8x bet</td>
                                </tr>
                                <tr>
                                    <td>5</td>
                                    <td>12x bet</td>
                                </tr>
                                <tr>
                                    <td>6</td>
                                    <td>20x bet</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            
            <!-- Betting History -->
            <div class="bg-gray-900 p-4">
                <h3 class="text-xl font-bold mb-3 text-center">Betting History</h3>
                <div class="overflow-x-auto">
                    <table class="min-w-full">
                        <thead>
                            <tr class="border-b border-gray-700">
                                <th class="px-4 py-2 text-left">Round</th>
                                <th class="px-4 py-2 text-left">Your Bet</th>
                                <th class="px-4 py-2 text-left">Occurrences</th>
                                <th class="px-4 py-2 text-right">Outcome</th>
                            </tr>
                        </thead>
                        <tbody id="historyTableBody">
                            <!-- History rows will be added here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        
        <!-- Game Instructions -->
        <div class="mt-8 bg-gray-800 rounded-xl p-6 shadow-lg">
            <h2 class="text-2xl font-bold mb-4 text-center text-yellow-400">How to Play</h2>
            <ol class="list-decimal pl-6 space-y-2 text-gray-300">
                <li>Choose a difficulty level: Easy (3 cubes) or Medium (6 cubes)</li>
                <li>Select a color to bet on</li>
                <li>Choose your bet amount using the betting chips or enter a custom amount</li>
                <li>Click "ROLL THE CUBES" to start the game</li>
                <li>Each cube has 6 sides with different colors</li>
                <li>Your payout depends on how many times your color appears:</li>
                <ul class="list-disc pl-6 mt-1">
                    <li>1 occurrence: 2x your bet</li>
                    <li>2 occurrences: 3x your bet</li>
                    <li>3 occurrences: 5x your bet</li>
                    <li>And so on (see payout table)</li>
                </ul>
                <li>If your color doesn't appear, you lose your bet</li>
            </ol>
        </div>
    </div>

    <script>
        // DOM Elements
        const cubesContainer = document.getElementById('cubesContainer');
        const rollButton = document.getElementById('rollButton');
        const colorOptions = document.querySelectorAll('.color-option');
        const resultMessage = document.getElementById('resultMessage');
        const balanceDisplay = document.getElementById('balanceDisplay');
        const betAmountDisplay = document.getElementById('betAmountDisplay');
        const selectedColorDisplay = document.getElementById('selectedColorDisplay');
        const historyTableBody = document.getElementById('historyTableBody');
        const customBetInput = document.getElementById('customBetInput');
        const setCustomBetBtn = document.getElementById('setCustomBetBtn');
        const easyBtn = document.getElementById('easyBtn');
        const mediumBtn = document.getElementById('mediumBtn');
        const bettingChips = document.querySelectorAll('.betting-chip');
        
        // Game Variables
        let playerBalance = 1000;
        let currentBet = 0;
        let selectedColor = null;
        let gameInProgress = false;
        let roundNumber = 1;
        let numCubes = 3; // Default to easy
        
        // All possible colors
        const allColors = [
            { name: 'Red', bgClass: 'bg-red-500' },
            { name: 'Blue', bgClass: 'bg-blue-500' },
            { name: 'Green', bgClass: 'bg-green-500' },
            { name: 'Yellow', bgClass: 'bg-yellow-500' },
            { name: 'Purple', bgClass: 'bg-purple-500' },
            { name: 'Orange', bgClass: 'bg-orange-500' }
        ];
        
        // Payout multipliers based on occurrences
        const payoutMultipliers = {
            1: 2,   // 1 occurrence: 2x bet
            2: 3,   // 2 occurrences: 3x bet
            3: 5,   // 3 occurrences: 5x bet
            4: 8,   // 4 occurrences: 8x bet
            5: 12,  // 5 occurrences: 12x bet
            6: 20   // 6 occurrences: 20x bet
        };
        
        // Cube face rotations for each color
        const cubeRotations = {
            'Red': 'rotateY(0deg)',
            'Blue': 'rotateY(180deg)',
            'Green': 'rotateY(90deg)',
            'Yellow': 'rotateY(-90deg)',
            'Purple': 'rotateX(90deg)',
            'Orange': 'rotateX(-90deg)'
        };
        
        // Initialize the game
        initGame();
        
        function initGame() {
            updateBalance(playerBalance);
            setupEventListeners();
            createCubes();
        }
        
        function setupEventListeners() {
            // Roll button click
            rollButton.addEventListener('click', rollCubes);
            
            // Color selection
            colorOptions.forEach(option => {
                option.addEventListener('click', function() {
                    const color = this.getAttribute('data-color');
                    const bgClass = this.className.split(' ').find(cls => cls.startsWith('bg-'));
                    selectColor(color, bgClass);
                });
            });
            
            // Betting chip selection
            bettingChips.forEach(chip => {
                chip.addEventListener('click', function() {
                    const amount = parseInt(this.getAttribute('data-amount'));
                    setBetAmount(amount);
                    
                    // Update visual selection
                    bettingChips.forEach(c => c.classList.remove('selected'));
                    this.classList.add('selected');
                });
            });
            
            // Custom bet button
            setCustomBetBtn.addEventListener('click', function() {
                const customAmount = parseInt(customBetInput.value);
                if (customAmount > 0 && customAmount <= playerBalance) {
                    setBetAmount(customAmount);
                    
                    // Remove selection from betting chips
                    bettingChips.forEach(c => c.classList.remove('selected'));
                } else {
                    alert('Please enter a valid bet amount (1 to ' + playerBalance + ')');
                }
            });
            
            // Difficulty buttons
            easyBtn.addEventListener('click', function() {
                setDifficulty('easy');
                easyBtn.classList.add('active', 'bg-blue-700');
                mediumBtn.classList.remove('active', 'bg-blue-700');
                mediumBtn.classList.add('bg-blue-600');
            });
            
            mediumBtn.addEventListener('click', function() {
                setDifficulty('medium');
                mediumBtn.classList.add('active', 'bg-blue-700');
                easyBtn.classList.remove('active', 'bg-blue-700');
                easyBtn.classList.add('bg-blue-600');
            });
        }
        
        function createCubes() {
            // Clear previous cubes
            cubesContainer.innerHTML = '';
            
            // Set grid columns based on number of cubes
            if (numCubes === 3) {
                cubesContainer.className = 'grid grid-cols-3 gap-4 mb-6';
            } else {
                cubesContainer.className = 'grid grid-cols-3 gap-4 mb-6';
            }
            
            // Create cubes
            for (let i = 0; i < numCubes; i++) {
                const scene = document.createElement('div');
                scene.className = 'scene';
                
                const cube = document.createElement('div');
                cube.className = 'cube';
                cube.id = `cube-${i}`;
                
                // Create cube faces
                allColors.forEach((color, index) => {
                    const face = document.createElement('div');
                    
                    // Determine which face this is
                    let faceClass;
                    switch (index) {
                        case 0: faceClass = 'front'; break;
                        case 1: faceClass = 'back'; break;
                        case 2: faceClass = 'right'; break;
                        case 3: faceClass = 'left'; break;
                        case 4: faceClass = 'top'; break;
                        case 5: faceClass = 'bottom'; break;
                    }
                    
                    face.className = `cube-face ${faceClass} ${color.bgClass}`;
                    cube.appendChild(face);
                });
                
                scene.appendChild(cube);
                cubesContainer.appendChild(scene);
            }
        }
        
        function selectColor(colorName, bgClass) {
            // Update selected color
            selectedColor = colorName;
            
            // Update visual display
            selectedColorDisplay.className = `w-6 h-6 rounded-full ${bgClass}`;
            
            // Update color options to show selection
            colorOptions.forEach(option => {
                if (option.getAttribute('data-color') === colorName) {
                    option.classList.add('selected');
                } else {
                    option.classList.remove('selected');
                }
            });
        }
        
        function setBetAmount(amount) {
            // Ensure bet doesn't exceed balance
            amount = Math.min(amount, playerBalance);
            
            // Update current bet
            currentBet = amount;
            betAmountDisplay.textContent = amount;
        }
        
        function setDifficulty(difficulty) {
            if (difficulty === 'easy') {
                numCubes = 3;
            } else {
                numCubes = 6;
            }
            
            createCubes();
        }
        
        function rollCubes() {
            // Validate bet and color selection
            if (currentBet <= 0) {
                alert('Please place a bet first!');
                return;
            }
            
            if (!selectedColor) {
                alert('Please select a color first!');
                return;
            }
            
            if (gameInProgress) {
                return;
            }
            
            // Deduct bet from balance
            updateBalance(playerBalance - currentBet);
            
            // Start game
            gameInProgress = true;
            rollButton.disabled = true;
            resultMessage.textContent = '';
            
            // Add spinning animation to all cubes
            const cubes = document.querySelectorAll('.cube');
            cubes.forEach(cube => {
                cube.classList.add('spinning');
            });
            
            // Determine results after animation
            setTimeout(() => {
                determineResults();
            }, 1500);
        }
        
        function determineResults() {
            // Remove spinning animation from all cubes
            const cubes = document.querySelectorAll('.cube');
            cubes.forEach(cube => {
                cube.classList.remove('spinning');
            });
            
            // Generate random results for each cube
            const results = [];
            for (let i = 0; i < numCubes; i++) {
                const randomIndex = Math.floor(Math.random() * allColors.length);
                const resultColor = allColors[randomIndex].name;
                results.push(resultColor);
                
                // Apply rotation to show the result
                const cube = document.getElementById(`cube-${i}`);
                cube.style.transform = cubeRotations[resultColor];
            }
            
            // Count occurrences of the selected color
            const occurrences = results.filter(color => color === selectedColor).length;
            
            // Determine if player won and calculate winnings
            if (occurrences > 0) {
                const multiplier = payoutMultipliers[occurrences] || 1;
                const winnings = currentBet * multiplier;
                
                updateBalance(playerBalance + winnings);
                resultMessage.textContent = `Your color appeared ${occurrences} time${occurrences > 1 ? 's' : ''}! You won $${winnings}!`;
                resultMessage.className = 'text-xl font-bold h-8 mb-4 text-center text-green-400';
                
                // Create confetti effect
                createConfetti();
            } else {
                resultMessage.textContent = `Your color didn't appear. You lost $${currentBet}!`;
                resultMessage.className = 'text-xl font-bold h-8 mb-4 text-center text-red-400';
            }
            
            // Add to history
            addToHistory(selectedColor, occurrences);
            
            // Reset game state
            setTimeout(() => {
                gameInProgress = false;
                rollButton.disabled = false;
            }, 1000);
        }
        
        function updateBalance(newBalance) {
            // Update balance with animation
            const oldBalance = playerBalance;
            playerBalance = newBalance;
            
            balanceDisplay.textContent = playerBalance;
            balanceDisplay.classList.add('balance-change');
            
            // Remove animation class after animation completes
            setTimeout(() => {
                balanceDisplay.classList.remove('balance-change');
            }, 500);
            
            // If balance is zero, show alert
            if (playerBalance <= 0) {
                setTimeout(() => {
                    alert('Game over! You ran out of money. Resetting balance to $1000.');
                    updateBalance(1000);
                }, 500);
            }
        }
        
        function addToHistory(betColor, occurrences) {
            const row = document.createElement('tr');
            row.className = 'border-b border-gray-700';
            
            // Determine outcome text and class
            let outcomeText, outcomeClass;
            if (occurrences > 0) {
                const multiplier = payoutMultipliers[occurrences] || 1;
                const winnings = currentBet * multiplier;
                outcomeText = `+$${winnings}`;
                outcomeClass = 'text-green-400';
            } else {
                outcomeText = `-$${currentBet}`;
                outcomeClass = 'text-red-400';
            }
            
            // Get color class
            const colorClass = allColors.find(color => color.name === betColor)?.bgClass || 'bg-gray-500';
            
            // Create row content
            row.innerHTML = `
                <td class="px-4 py-2">${roundNumber}</td>
                <td class="px-4 py-2">
                    <span class="inline-block w-4 h-4 rounded-full ${colorClass} mr-2"></span>
                    ${betColor}
                </td>
                <td class="px-4 py-2">${occurrences}</td>
                <td class="px-4 py-2 text-right font-bold ${outcomeClass}">${outcomeText}</td>
            `;
            
            // Add to table
            historyTableBody.prepend(row);
            
            // Increment round number
            roundNumber++;
            
            // Limit history to 10 rows
            if (historyTableBody.children.length > 10) {
                historyTableBody.removeChild(historyTableBody.lastChild);
            }
        }
        
        function createConfetti() {
            // Create 50 confetti pieces
            for (let i = 0; i < 50; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                
                // Random position
                const left = Math.random() * 100;
                confetti.style.left = `${left}vw`;
                
                // Random color
                const colors = ['#f00', '#0f0', '#00f', '#ff0', '#f0f', '#0ff'];
                const colorIndex = Math.floor(Math.random() * colors.length);
                confetti.style.backgroundColor = colors[colorIndex];
                
                // Random size
                const size = Math.random() * 10 + 5;
                confetti.style.width = `${size}px`;
                confetti.style.height = `${size}px`;
                
                // Random rotation
                confetti.style.transform = `rotate(${Math.random() * 360}deg)`;
                
                // Random animation duration
                const duration = Math.random() * 2 + 2;
                confetti.style.animationDuration = `${duration}s`;
                
                // Add to body
                document.body.appendChild(confetti);
                
                // Remove after animation
                setTimeout(() => {
                    document.body.removeChild(confetti);
                }, duration * 1000);
            }
        }
        
        // Initialize with easy difficulty
        setDifficulty('easy');
    </script>
</body>
</html>